# 🚀 RAG 評估系統 v2.0 快速開始

## 一、安裝（5 分鐘）

```bash
# 進入專案目錄
cd /Users/chunglingchuang/Desktop/安然-聯成化科_V3

# 安裝套件（擇一）

# 選項 1: 最小安裝（僅關鍵詞評估）
pip install pandas numpy jieba streamlit plotly openpyxl xlsxwriter

# 選項 2: 推薦安裝（關鍵詞 + 語義）【推薦】
pip install -r requirements_v2.txt

# 選項 3: 完整安裝（包含開發工具）
pip install -r requirements_v2.txt
```

## 二、啟動（1 分鐘）

```bash
# 啟動儀表板
streamlit run streamlit_dashboard_v2_with_manual_gpt.py
```

瀏覽器會自動開啟 → http://localhost:8501

## 三、操作流程（10-30 分鐘）

### Step 1: 上傳檔案
1. 在左側邊欄選擇「📂 本地資料夾」或「📤 上傳檔案」
2. 選擇您的測試資料 Excel/CSV 檔案

### Step 2: 配置評估
1. 勾選「✅ 啟用語義相似度評估」（推薦）
2. 勾選「✅ 啟用 GPT 人工評審」（免費）
3. 調整權重（可使用預設值）

### Step 3: 查看自動評估結果
1. 點擊「📊 評估總覽」
2. 查看關鍵詞覆蓋率、語義相似度

### Step 4: 進行 GPT 評審（可選但推薦）
1. 點擊「🤖 GPT 人工評審」
2. 選擇要評審的問題
3. 複製左側「原始版本」的 Prompt → 貼到 ChatGPT
4. 複製 ChatGPT 的 JSON 回應 → 貼回「📥 貼上 ChatGPT 的 JSON 回應」
5. 點擊「✅ 確認並儲存評分」
6. 重複步驟 3-5 評審「優化版本」
7. 返回「📊 評估總覽」查看更新後的結果

### Step 5: 匯出結果
1. 點擊「📥 下載結果」
2. 點擊「生成完整報告」→ 下載 Excel

---

## 四、範例資料格式

您的 Excel/CSV 檔案需要包含：

| 序號 | 測試問題 | 應回答之詞彙 | 向量知識庫（原始版） | 智慧文檔知識庫（彙整版） |
|------|---------|-------------|-------------------|---------------------|
| 1 | 請問工作許可證的申請流程為何？ | 工作許可證、申請流程、包商名稱 | 需要向工安部門申請... | 工作許可證的申請流程包括... |

**欄位說明**:
- `序號`: 問題編號
- `測試問題`: 要測試的問題
- `應回答之詞彙`: 期望回答包含的關鍵詞（用逗號或頓號分隔）
- `向量知識庫（原始版）`: 原始版本的 AI 回答
- `智慧文檔知識庫（彙整版）`: 優化版本的 AI 回答

---

## 五、常見問題速查

### ❓ 語義相似度顯示 0？
```bash
pip install sentence-transformers torch
```

### ❓ ChatGPT 回應無法解析？
確保複製完整的 JSON 格式，包含 `{` 和 `}`

### ❓ 如何只評審部分問題？
沒問題！未評審的問題會自動跳過，不影響其他評估

### ❓ 可以重新評審嗎？
可以！再次貼上新的 GPT 回應即可覆蓋

### ❓ 忠誠度下降怎麼辦？
這不一定是壞事！查看 GPT 的「相關性」和「完整性」評分綜合判斷

---

## 六、推薦評估策略

### 🔰 初學者（30 分鐘）
```
✅ 關鍵詞匹配（自動）
✅ 語義相似度（自動）
✅ GPT 評審（抽樣 5-10 題）
```

### 🎯 標準流程（1 小時）
```
✅ 關鍵詞匹配（自動）
✅ 語義相似度（自動）
✅ GPT 評審（全部問題）
```

### 💎 深度分析（2 小時）
```
✅ 關鍵詞匹配（自動）
✅ 語義相似度（自動）
✅ GPT 評審（全部問題 + 多維度分析）
```

---

## 七、檔案結構

```
安然-聯成化科_V3/
├── streamlit_dashboard_v2_with_manual_gpt.py  ⭐ 主程式（啟動這個）
├── rag_evaluation_two_models_v2.py            📊 評估引擎
├── gpt_manual_evaluation_helper.py            🤖 GPT 輔助工具（選用）
├── requirements_v2.txt                        📦 相依套件清單
├── README_v2.md                               📖 完整說明文件
├── 使用指南_v2.md                              📘 詳細使用指南
├── 快速開始.md                                 🚀 本文件
└── test_data/                                 📁 測試資料夾
    └── 您的測試資料.xlsx
```

---

## 八、需要幫助？

1. **詳細使用指南**: 查看 `使用指南_v2.md`
2. **完整文檔**: 查看 `README_v2.md`
3. **技術支援**: 聯繫技術團隊

---

## 九、升級說明（給 v1.0 使用者）

### v2.0 新功能
- ✨ 三層評估架構（關鍵詞 + 語義 + GPT）
- ✨ GPT 人工評審（零 API 成本）
- ✨ 所有指標同時呈現
- ✨ 即時更新評估結果

### 資料相容性
- ✅ v1.0 的資料檔案可以直接在 v2.0 使用
- ✅ 不需要修改資料格式
- ✅ v1.0 和 v2.0 可以並存

### 遷移建議
1. 保留 v1.0 檔案作為備份
2. 使用 v2.0 進行新的評估
3. 比較 v1.0 和 v2.0 的結果

---

## 十、實用技巧

### 💡 提高效率
- 使用 ChatGPT 一次評審 5-10 題（批次處理）
- 優先評審「效果退步」的問題
- 使用「篩選顯示」快速定位問題

### 💡 提高準確度
- 啟用語義相似度評估
- 對關鍵問題使用 GPT 深度評審
- 調整權重以符合您的評估重點

### 💡 節省時間
- 使用預設權重配置
- 僅對低分問題進行 GPT 評審
- 定期匯出結果避免重複工作

---

**開始您的評估之旅吧！** 🎉

如有任何問題，請參考：
- 📘 `使用指南_v2.md` - 詳細操作步驟
- 📖 `README_v2.md` - 完整技術文檔
